{% extends "base.html" %}

{% block title %}Fatura {{ format_month(bill.reference_month) }} - Landlord{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2>Fatura - {{ format_month(bill.reference_month) }}</h2>
        <p class="text-muted mb-0">Cobrança: {{ billing.name }}</p>
    </div>
    <div>
        {% if bill.pdf_path %}
        <a href="/bills/{{ bill.id }}/invoice" target="_blank" class="btn btn-primary">Ver PDF</a>
        {% endif %}
        <a href="/bills/{{ bill.id }}/edit" class="btn btn-outline-secondary">Editar</a>
    </div>
</div>

<div class="card mb-4">
    <div class="table-responsive">
        <table class="table mb-0">
            <thead>
                <tr>
                    <th>Descrição</th>
                    <th class="text-center">Tipo</th>
                    <th class="text-end">Valor</th>
                </tr>
            </thead>
            <tbody>
                {% for item in bill.line_items %}
                <tr>
                    <td>{{ item.description }}</td>
                    <td class="text-center">
                        {% if item.item_type == "fixed" %}
                        <span class="badge badge-fixed">Fixo</span>
                        {% elif item.item_type == "variable" %}
                        <span class="badge badge-variable">Variável</span>
                        {% else %}
                        <span class="badge badge-extra">Extra</span>
                        {% endif %}
                    </td>
                    <td class="text-end">{{ format_brl(item.amount) }}</td>
                </tr>
                {% endfor %}
            </tbody>
            <tfoot>
                <tr class="table-active">
                    <td colspan="2" class="text-end"><strong>Total</strong></td>
                    <td class="text-end"><strong>{{ format_brl(bill.total_amount) }}</strong></td>
                </tr>
            </tfoot>
        </table>
    </div>
</div>

{% if bill.due_date %}
<p><strong>Vencimento:</strong> {{ bill.due_date }}</p>
{% endif %}

{% if bill.notes %}
<div class="card mb-4">
    <div class="card-header"><h6 class="mb-0">Observações</h6></div>
    <div class="card-body">{{ bill.notes }}</div>
</div>
{% endif %}

<a href="/billings/{{ billing.id }}" class="btn btn-outline-secondary">Voltar</a>
{% endblock %}
